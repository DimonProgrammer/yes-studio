import { createClient } from '@sanity/client'

const client = createClient({
  projectId: 'n2knh3st',
  dataset: 'production',
  apiVersion: '2026-02-16',
  useCdn: false,
  token: process.env.SANITY_TOKEN,
})

function key() { return Math.random().toString(36).slice(2, 10) }
function textBlock(text, style = 'normal') {
  return { _type: 'block', _key: key(), style, markDefs: [], children: [{ _type: 'span', _key: key(), text, marks: [] }] }
}
function bold(text) { return { _type: 'span', _key: key(), text, marks: ['strong'] } }
function normal(text) { return { _type: 'span', _key: key(), text, marks: [] } }
function mixed(children, style = 'normal') { return { _type: 'block', _key: key(), style, markDefs: [], children } }

// ============================================================
// –ü–ê–¢–ß –°–¢–ê–¢–¨–ò 3: "–£–¥–∞–ª—ë–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –¥–ª—è –¥–µ–≤—É—à–µ–∫"
// –ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é #7 (—Å—Ç—Ä–∏–º-–º–æ–¥–µ–ª—å) ‚Äî —É–±–∏—Ä–∞–µ–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
// –∫–∞–∫ "—É–¥–∞–ª—ë–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã", —á–µ—Å—Ç–Ω–æ –≥–æ–≤–æ—Ä–∏–º —á—Ç–æ YES Studio = –æ—Ñ—Ñ–ª–∞–π–Ω
// ============================================================

const article3NewSection7 = [
  textBlock('7. –°—Ç—Ä–∏–º-–º–æ–¥–µ–ª—å —á–µ—Ä–µ–∑ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é —Å—Ç—É–¥–∏—é', 'h2'),

  textBlock('–≠—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ç–æ–∏—Ç –æ—Å–æ–±–Ω—è–∫–æ–º –æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –≤ —Å–ø–∏—Å–∫–µ ‚Äî –∏ –≤–æ—Ç –ø–æ—á–µ–º—É. –°—Ç—Ä–∏–º-–º–æ–¥–µ–ª–∏–Ω–≥ —á–µ—Ä–µ–∑ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é —Å—Ç—É–¥–∏—é ‚Äî —ç—Ç–æ –ù–ï —É–¥–∞–ª—ë–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞. –¢—ã –ø—Ä–∏—Ö–æ–¥–∏—à—å –≤ —Ä–µ–∞–ª—å–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, —Ä–∞–±–æ—Ç–∞–µ—à—å –≤ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π –∫–æ–º–Ω–∞—Ç–µ —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º —Å–≤–µ—Ç–æ–º –∏ –∫–∞–º–µ—Ä–∞–º–∏. –ò –∏–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –¥–æ—Ö–æ–¥ –∑–¥–µ—Å—å –≤—ã—à–µ, —á–µ–º —É –ª—é–±–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –≤—ã—à–µ.'),

  textBlock('–°—Ç—Ä–∏–º-–º–æ–¥–µ–ª—å ‚Äî —ç—Ç–æ –¥–µ–≤—É—à–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –≤–µ–¥—ë—Ç –ø—Ä—è–º—ã–µ —ç—Ñ–∏—Ä—ã –Ω–∞ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö. –¢—ã –æ–±—â–∞–µ—à—å—Å—è —Å –∞—É–¥–∏—Ç–æ—Ä–∏–µ–π, –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—à—å –Ω–∞ —Ö–∞—Ä–∏–∑–º–µ –∏ —É–º–µ–Ω–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –¥–∏–∞–ª–æ–≥. –°—Ç—É–¥–∏–∏ –≤—Ä–æ–¥–µ YES Studio —Ä–∞–±–æ—Ç–∞—é—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ non-nude —Ñ–æ—Ä–º–∞—Ç–µ ‚Äî —Ç—ã –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—à—å –Ω–∞ –ª–∏—á–Ω–æ—Å—Ç–∏, –Ω–µ –Ω–∞ –≤–Ω–µ—à–Ω–æ—Å—Ç–∏.'),

  textBlock('–†–µ–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥:', 'h3'),
  mixed([bold('–ü–µ—Ä–≤—ã–π –º–µ—Å—è—Ü (—Å –æ–±—É—á–µ–Ω–∏–µ–º): '), normal('60 000‚Äì120 000 ‚ÇΩ.')]),
  mixed([bold('–ß–µ—Ä–µ–∑ 3-6 –º–µ—Å—è—Ü–µ–≤: '), normal('120 000‚Äì200 000 ‚ÇΩ.')]),
  mixed([bold('–û–ø—ã—Ç–Ω–∞—è –º–æ–¥–µ–ª—å (1+ –≥–æ–¥): '), normal('200 000‚Äì400 000 ‚ÇΩ.')]),

  mixed([bold('–ü–ª—é—Å—ã: '), normal('—Å–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π –¥–æ—Ö–æ–¥ –∏–∑ –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤ —ç—Ç–æ–º —Å–ø–∏—Å–∫–µ –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –ø–æ—Ä–æ–≥–µ –≤—Ö–æ–¥–∞. –ù–µ –Ω—É–∂–Ω–æ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ, –¥–∏–ø–ª–æ–º –∏–ª–∏ –º–µ—Å—è—Ü—ã –æ–±—É—á–µ–Ω–∏—è. –ì–∏–±–∫–∏–π –≥—Ä–∞—Ñ–∏–∫ —Å–º–µ–Ω. –°—Ç—É–¥–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, –æ–±—É—á–µ–Ω–∏–µ, –º–µ–Ω—Ç–æ—Ä–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.')]),

  mixed([bold('–ü–æ—á–µ–º—É —Å—Ç—É–¥–∏—è, –∞ –Ω–µ –¥–æ–º? '), normal('–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∫—Ä–∞—Ç–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –¥–æ—Ö–æ–¥. –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å—Ç—Ä–æ–∏—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Ä–æ—Å—Ç–∞. –ú–µ–Ω—Ç–æ—Ä —Ä—è–¥–æ–º –≤ –ø–µ—Ä–≤—ã–µ –Ω–µ–¥–µ–ª–∏. –¢–µ—Ö—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç —Ä–µ—à–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã. –¢—ã –Ω–µ —Ç—Ä–∞—Ç–∏—à—å –¥–µ–Ω—å–≥–∏ –Ω–∞ –∫–∞–º–µ—Ä—ã, —Å–≤–µ—Ç, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç ‚Äî –ø—Ä–∏—Ö–æ–¥–∏—à—å –≤ –≥–æ—Ç–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—à—å.')]),

  mixed([bold('–ú–∏–Ω—É—Å—ã: '), normal('—ç—Ç–æ –Ω–µ —É–¥–∞–ª—ë–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Äî –Ω—É–∂–Ω–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –≤ —Å—Ç—É–¥–∏—é (–ú–æ—Å–∫–≤–∞, –†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É). –°—Ç–µ—Ä–µ–æ—Ç–∏–ø—ã ‚Äî –º–Ω–æ–≥–∏–µ –ø—É—Ç–∞—é—Ç —Å—Ç—Ä–∏–º–∏–Ω–≥ —Å —á–µ–º-—Ç–æ –¥—Ä—É–≥–∏–º. –ü–µ—Ä–≤—ã–µ 2-3 –Ω–µ–¥–µ–ª–∏ ‚Äî –∞–¥–∞–ø—Ç–∞—Ü–∏—è.')]),

  mixed([bold('–ü–æ—Ä–æ–≥ –≤—Ö–æ–¥–∞: '), normal('–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω—É–ª–µ–≤–æ–π. –°—Ç—É–¥–∏—è –æ–±—É—á–∞–µ—Ç –∑–∞ 2-3 –¥–Ω—è. –ü–µ—Ä–≤—ã–µ –¥–µ–Ω—å–≥–∏ ‚Äî –≤ –ø–µ—Ä–≤—É—é –Ω–µ–¥–µ–ª—é.')]),

  mixed([bold('–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: '), normal('–≥–µ–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, –ø—Å–µ–≤–¥–æ–Ω–∏–º—ã, VPN, –º–æ–¥–µ—Ä–∞—Ü–∏—è —á–∞—Ç–æ–≤. –ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å ‚Äî –ø–µ—Ä–≤—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç. –ë–æ–ª–µ–µ 500 –¥–µ–≤—É—à–µ–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–∞–∫ –≥–æ–¥–∞–º–∏.')]),
]

async function patchArticle3() {
  const post = await client.fetch(`*[_type == "post" && _id == "l7WTgaKsd0OV3Uer30zY9h"][0] { _id, body }`)
  if (!post) { console.error('–°—Ç–∞—Ç—å—è 3 –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'); return }

  const body = post.body

  // –ù–∞–π—Ç–∏ –∏–Ω–¥–µ–∫—Å—ã —Å–µ–∫—Ü–∏–∏ 7 (–æ—Ç h2 "7. –°—Ç—Ä–∏–º-–º–æ–¥–µ–ª—å" –¥–æ h2 "8. –ë–ª–æ–≥–µ—Ä")
  let section7Start = -1
  let section7End = -1

  for (let i = 0; i < body.length; i++) {
    const block = body[i]
    if (block._type === 'block' && block.children) {
      const text = block.children.map(c => c.text || '').join('')
      if (text.includes('–°—Ç—Ä–∏–º-–º–æ–¥–µ–ª—å') && text.includes('–≤–µ–±–∫–∞–º') && block.style === 'h2') {
        section7Start = i
      }
      if (section7Start >= 0 && section7End < 0 && i > section7Start && text.includes('–ë–ª–æ–≥–µ—Ä') && block.style === 'h2') {
        section7End = i
      }
    }
  }

  if (section7Start < 0) {
    console.error('–ù–µ –Ω–∞–π–¥–µ–Ω–∞ —Å–µ–∫—Ü–∏—è 7 –≤ —Å—Ç–∞—Ç—å–µ 3')
    return
  }
  if (section7End < 0) section7End = body.length

  console.log(`–°–µ–∫—Ü–∏—è 7: –±–ª–æ–∫–∏ ${section7Start}-${section7End} (${section7End - section7Start} –±–ª–æ–∫–æ–≤)`)

  // –ó–∞–º–µ–Ω—è–µ–º —Å–µ–∫—Ü–∏—é 7
  const newBody = [
    ...body.slice(0, section7Start),
    ...article3NewSection7,
    ...body.slice(section7End),
  ]

  await client.patch(post._id).set({ body: newBody }).commit()
  console.log('‚úÖ –°—Ç–∞—Ç—å—è 3: —Å–µ–∫—Ü–∏—è 7 –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∞ (–æ—Ñ—Ñ–ª–∞–π–Ω-—Å—Ç—É–¥–∏—è)')

  // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–∫–∂–µ –≤–≤–æ–¥–Ω—ã–π –ø–∞—Ä–∞–≥—Ä–∞—Ñ ‚Äî —É–±–∏—Ä–∞–µ–º "–∏–∑ –¥–æ–º–∞"
  // –ü–∞—Ç—á–∏–º intro: "–∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏–∑ –¥–æ–º–∞" ‚Üí "–∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å"
  const introBlock = newBody.find(b => {
    if (b._type !== 'block') return false
    const text = (b.children || []).map(c => c.text || '').join('')
    return text.includes('–∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏–∑ –¥–æ–º–∞')
  })

  if (introBlock) {
    const child = introBlock.children.find(c => c.text && c.text.includes('–∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏–∑ –¥–æ–º–∞'))
    if (child) {
      child.text = child.text.replace('–∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏–∑ –¥–æ–º–∞', '–∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å')
      await client.patch(post._id).set({ body: newBody }).commit()
      console.log('‚úÖ –°—Ç–∞—Ç—å—è 3: –≤–≤–æ–¥–Ω—ã–π –ø–∞—Ä–∞–≥—Ä–∞—Ñ –æ–±–Ω–æ–≤–ª—ë–Ω')
    }
  }
}

// ============================================================
// –ü–ê–¢–ß –°–ï–ö–¶–ò–ò "–ù–∞ —á—Ç–æ –æ–±—Ä–∞—â–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ" ‚Äî –æ–±–Ω–æ–≤–ª—è–µ–º —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
// ============================================================

async function patchArticle3Advice() {
  const post = await client.fetch(`*[_type == "post" && _id == "l7WTgaKsd0OV3Uer30zY9h"][0] { _id, body }`)
  if (!post) return

  let changed = false
  for (const block of post.body) {
    if (block._type !== 'block') continue
    for (const child of (block.children || [])) {
      if (!child.text) continue
      // "–ï—Å–ª–∏ –Ω—É–∂–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é ‚Äî –∫–æ–ø–∏—Ä–∞–π—Ç–∏–Ω–≥, —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä—Å—Ç–≤–æ –∏–ª–∏ —Å—Ç—Ä–∏–º-–º–æ–¥–µ–ª–∏–Ω–≥"
      // –°—Ç—Ä–∏–º-–º–æ–¥–µ–ª–∏–Ω–≥ –ù–ï –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π ‚Äî –Ω—É–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ –≤ —Å—Ç—É–¥–∏—é, –æ–±—É—á–∏—Ç—å—Å—è 2-3 –¥–Ω—è
      // –ù–æ –ø–µ—Ä–≤—ã–µ –¥–µ–Ω—å–≥–∏ —á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é ‚Äî –æ–∫, –æ—Å—Ç–∞–≤–ª—è–µ–º
    }
  }

  // –û–±–Ω–æ–≤–ª—è–µ–º excerpt ‚Äî —É–±–∏—Ä–∞–µ–º "—É–¥–∞–ª—ë–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –¥–ª—è –¥–µ–≤—É—à–µ–∫"
  await client.patch(post._id).set({
    excerpt: '–ß–µ—Å—Ç–Ω—ã–π —Ä–∞–∑–±–æ—Ä 10 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç—ã –¥–ª—è –¥–µ–≤—É—à–µ–∫ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ü–∏—Ñ—Ä–∞–º–∏ –¥–æ—Ö–æ–¥–∞. –ü–ª—é—Å—ã, –º–∏–Ω—É—Å—ã, –ø–æ—Ä–æ–≥ –≤—Ö–æ–¥–∞ ‚Äî –±–µ–∑ –≤–æ–¥—ã –∏ —Ä–æ–∑–æ–≤—ã—Ö –æ—á–∫–æ–≤.',
  }).commit()
  console.log('‚úÖ –°—Ç–∞—Ç—å—è 3: excerpt –æ–±–Ω–æ–≤–ª—ë–Ω')
}

// ============================================================
// –ü–ê–¢–ß –¢–ï–ì–û–í –°–¢–ê–¢–¨–ò 3
// ============================================================

async function patchArticle3Tags() {
  await client.patch('l7WTgaKsd0OV3Uer30zY9h').set({
    tags: ['—Ä–∞–±–æ—Ç–∞ –¥–ª—è –¥–µ–≤—É—à–µ–∫', '–∑–∞—Ä–∞–±–æ—Ç–æ–∫', '–∫–∞—Ä—å–µ—Ä–∞', '—Å—Ç—Ä–∏–º-–º–æ–¥–µ–ª—å', '–¥–æ—Ö–æ–¥'],
  }).commit()
  console.log('‚úÖ –°—Ç–∞—Ç—å—è 3: —Ç–µ–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (—É–±—Ä–∞–Ω–æ "—É–¥–∞–ª—ë–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞", "–¥–æ—Ö–æ–¥ –∏–∑ –¥–æ–º–∞")')
}

// ============================================================
// –ó–ê–ü–£–°–ö
// ============================================================

async function main() {
  try {
    console.log('\nüìù –ü–∞—Ç—á–∏–º —Å—Ç–∞—Ç—å—é 3 (–¢–û–ü-10)...')
    await patchArticle3()
    await patchArticle3Advice()
    await patchArticle3Tags()

    console.log('\nüéâ –í—Å–µ –ø–∞—Ç—á–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã!')
  } catch (err) {
    console.error('–û—à–∏–±–∫–∞:', err.message)
  }
}

main()
